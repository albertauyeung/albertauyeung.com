<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-30554548-1"></script>
    <script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'UA-30554548-1');</script>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="turbo-cache-control" content="no-cache">

    <!-- Primary Meta Tags -->
    <title>Performing Sequence Labelling using CRF in Python | Albert Au Yeung</title>
    <meta name="title" content="Performing Sequence Labelling using CRF in Python | Albert Au Yeung">
    <meta name="description" content="In natural language processing, it is a common task to extract words or phrases of particular types" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://albertauyeung.github.io/2017/06/17/python-sequence-labelling-with-crf.html/">
    <meta property="og:title" content="Performing Sequence Labelling using CRF in Python | Albert Au Yeung">
    <meta property="og:description" content="In natural language processing, it is a common task to extract words or phrases of particular types">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://albertauyeung.github.io/2017/06/17/python-sequence-labelling-with-crf.html/">
    <meta property="twitter:title" content="Performing Sequence Labelling using CRF in Python | Albert Au Yeung">
    <meta property="twitter:description" content="In natural language processing, it is a common task to extract words or phrases of particular types">
    
    <script>(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="/resources/css/retype.css?v=1.10.693339296789" rel="stylesheet" data-turbo-track="reload" />

    <script type="text/javascript" src="/resources/js/config.js?v=1.10.693339296789" defer data-turbo-track="reload"></script>
    <script type="text/javascript" src="/resources/js/retype.js?v=1.10" defer data-turbo-track="reload"></script>
    <script id="prism-js" type="text/javascript" src="/resources/js/prism.js?v=1.10.693339296789" defer></script>
    <link href="/resources/css/katex.css?v=1.10" rel="stylesheet" />
    <script id="katex-js" type="text/javascript" src="/resources/js/katex.js?v=1.10" defer></script>
<style>
.docs-markdown h1 { font-size: 1.75rem; }
.docs-markdown h2 { font-size: 1.45rem; }
.text-base { font-size: 0.95rem; }
</style>
</head>
    <body>
        <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
    <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>

    <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
    <div class="container relative flex items-center justify-between flex-grow pr-6 md:justify-start">
        <!-- Mobile menu button skeleton -->
        <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center flex-shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px flex-shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
        <div v-cloak id="docs-sidebar-toggle"></div>

        <!-- Logo -->
        <div class="flex items-center justify-between h-full py-2 md:w-75">
            <div class="flex items-center px-2 md:px-6">
                <a id="docs-site-logo" href="/" class="flex items-center leading-snug text-xl">
                    <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">Albert Au Yeung</span>
                </a>
            </div>

            <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
        </div>

        <div class="flex justify-between md:flex-grow">
            <!-- Top Nav -->
            <nav class="hidden md:flex">
    <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
        <li class="md:mr-6">
            <a class="inline-flex items-center py-2 md:mb-0 text-sm text-gray-400 whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://www.linkedin.com/in/albert-au-yeung/" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                    <g fill="currentColor">
                        <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
                    </g>
                </svg>
                <span>LinkedIn</span>
            </a>
        </li>
        <li class="md:mr-6">
            <a class="inline-flex items-center py-2 md:mb-0 text-sm text-gray-400 whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://www.github.com/albertauyeung" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                    <g fill="currentColor">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </g>
                </svg>
                <span>Github</span>
            </a>
        </li>
        <li class="md:mr-6">
            <a class="inline-flex items-center py-2 md:mb-0 text-sm text-gray-400 whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://twitter.com/albertauyeung" target="_blank">
                <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                    <g fill="currentColor">
                        <g fill="currentColor"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-.139 9.237c.209 4.617-3.234 9.765-9.33 9.765-1.854 0-3.579-.543-5.032-1.475 1.742.205 3.48-.278 4.86-1.359-1.437-.027-2.649-.976-3.066-2.28.515.098 1.021.069 1.482-.056-1.579-.317-2.668-1.739-2.633-3.26.442.246.949.394 1.486.411-1.461-.977-1.875-2.907-1.016-4.383 1.619 1.986 4.038 3.293 6.766 3.43-.479-2.053 1.08-4.03 3.199-4.03.943 0 1.797.398 2.395 1.037.748-.147 1.451-.42 2.086-.796-.246.767-.766 1.41-1.443 1.816.664-.08 1.297-.256 1.885-.517-.439.656-.996 1.234-1.639 1.697z"></path></g>
                    </g>
                </svg>
                <span>Twitter</span>
            </a>
        </li>
    </ul>
</nav>

            <!-- Header Right Skeleton -->
            <div v-cloak class="flex justify-end flex-grow skeleton">

                <!-- Search input mock -->
                <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                    <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                    </div>

                    <input class="w-full h-10 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 placeholder-gray-400 dark:placeholder-dark-400"
                    style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search docs" />
                </div>

                <!-- Mobile search button mock -->
                <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                </div>

                <!-- Dark mode switch placehokder -->
                <div class="w-10 h-10 lg:ml-2"></div>

                <!-- History button mock -->
                <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                    <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                </div>
            </div>

            <div v-cloak class="flex items-center justify-end flex-grow">
                <div id="docs-mobile-search-button"></div>
                <doc-search-desktop></doc-search-desktop>

                <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                <doc-history></doc-history>
            </div>
        </div>
    </div>
</header>


    <div class="container relative flex bg-white">
        <!-- Sidebar Skeleton -->
<div v-cloak class="fixed flex flex-col flex-shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">

    <!-- Render this div, if config.showSidebarFilter is `true` -->
    <div class="flex items-center h-16 px-6">
        <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter" />
    </div>

    <div class="pl-6 mb-4 mt-1">
        <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
        <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
        <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
        <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
        <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
        <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
    </div>

    <div class="flex-shrink-0 mt-auto bg-transparent dark:border-dark-650">
        <a
    class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in"
    target="_blank"
    href="https://retype.com/"
    rel="noopener"
>
    <span class="text-xs whitespace-nowrap">Powered by</span>
    <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
</a>

    </div>
</div>

<!-- Sidebar component -->
<doc-sidebar v-cloak>
    <template #sidebar-footer>
        <div
            class="flex-shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650"
        >

            <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                <nav>
                    <ul class="flex flex-wrap justify-center items-center">
                        <li class="mr-6">
                            <a class="block py-1 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://www.linkedin.com/in/albert-au-yeung/">LinkedIn</a>
                        </li>
                        <li class="mr-6">
                            <a class="block py-1 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://www.github.com/albertauyeung">Github</a>
                        </li>
                        <li class="mr-6">
                            <a class="block py-1 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://twitter.com/albertauyeung">Twitter</a>
                        </li>
                    </ul>
                </nav>
            </div>

            <a
    class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in"
    target="_blank"
    href="https://retype.com/"
    rel="noopener"
>
    <span class="text-xs whitespace-nowrap">Powered by</span>
    <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
</a>

        </div>
    </template>
</doc-sidebar>


        <div class="flex-grow min-w-0 dark:bg-dark-850">
            <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
            <div class="flex">
    <div class="flex-grow min-w-0 px-6 md:px-16">
        <main class="relative pt-6 pb-16">
            <div class="docs-markdown" id="docs-content">
                <!-- Rendered if sidebar right is enabled -->
                <div id="docs-sidebar-right-toggle"></div>
               
                <!-- Page content  -->
<doc-anchor-target id="performing-sequence-labelling-using-crf-in-python" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#performing-sequence-labelling-using-crf-in-python">#</doc-anchor-trigger>
        <span>Performing Sequence Labelling using CRF in Python</span>
    </h1>
</doc-anchor-target>
<div class="-mt-3 mb-12 flex flex-wrap text-sm text-gray-400 dark:text-dark-350">
    <div class="flex items-center flex-shrink-0">Published&nbsp;<span>2017-06-17</span></div>
</div>

<doc-anchor-target id="sequence-labelling-in-nlp">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#sequence-labelling-in-nlp">#</doc-anchor-trigger>
        <span>Sequence Labelling in NLP</span>
    </h2>
</doc-anchor-target>
<p>In <a href="https://en.wikipedia.org/wiki/Natural_language_processing">natural language processing</a>, it is a common task to <strong>extract words or phrases of particular types</strong> from a given sentence or paragraph. For example, when performing analysis of a corpus of news articles, we may want to know which countries are mentioned in the articles, and how many articles are related to each of these countries.</p>
<p>This is actually a special case of <strong>sequence labelling</strong> in NLP (others include <a href="https://en.wikipedia.org/wiki/Part-of-speech_tagging">POS tagging</a> and <a href="https://en.wikipedia.org/wiki/Shallow_parsing">Chunking</a>), in which the goal is to assign a label to each member in the sequence. In the case of identifying country names, we would like to assign a &#x27;<em>country</em>&#x27; label to words that form part of a country name, and a &#x27;<em>irrelevant</em>&#x27; label to all other words. For example, the following is a sentence broken down into tokens, and its desired output after the sequence labelling process:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">input = [&quot;Paris&quot;, &quot;is&quot;, &quot;the&quot;, &quot;capital&quot;, &quot;of&quot;, &quot;France&quot;]
output = [&quot;I&quot;, &quot;I&quot;, &quot;I&quot;, &quot;I&quot;, &quot;I&quot;, &quot;C&quot;]</code></pre>
</doc-codeblock></div>
<p>where <em>I</em> means that the token of that position is an irrelevant word, and <em>C</em> means that the token of that position is a word that form part of a country name.</p>
<doc-anchor-target id="methods-of-sequence-labelling">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#methods-of-sequence-labelling">#</doc-anchor-trigger>
        <span>Methods of Sequence Labelling</span>
    </h2>
</doc-anchor-target>
<p>A simple, though sometimes quite useful, approach is to prepare a <strong>dictionary</strong> of country names, and look for these names in each of the sentences in the corpus. However, this method relies heavily on the comprehensiveness of the dictionary. While there is a limited number of countries, in other cases such as city names the number of possible entries in the dictionary can be huge. Even for countries, many countries may be referred to using different sequence of characters in different contexts. For example, the United States of America may be referred to in an article as <em>the USA</em>, <em>the States</em>, or simply <em>America</em>.</p>
<p>In fact, a person reading a news article would usually recognise that a word or a phrase refers to a country, even when he or she has not seen the name of that country before. The reason is that there are many differnt <strong>cues</strong> in the sentence or the whole article that can be used to determine whether a word or a phrase is a country name. Take the following two sentences as examples:</p>
<ul>
<li>Kerry travels to <strong>Laos</strong>&#x27;s capital, Vientiane, on Monday for meetings of foreign ministers from the 10-member Association of South East Asia Nations (ASEAN).</li>
<li>The Governments of <strong>Bolivia</strong> and <strong>Uruguay</strong> will strengthen ties with a customs cooperation agreement to be in force on June 15th.</li>
</ul>
<p>The first sentence implies that something called <strong>Lao</strong> has a capital, suggesting that <strong>Lao</strong> is a country. Similarly, in the second sentence we know that both <strong>Bolivia</strong> and <strong>Uruguay</strong> are countries as the news mentioned about their governments. In other words, the words around &#x27;Lao&#x27;, &#x27;Bolivia&#x27; and &#x27;Uruguay&#x27; provide clues as to whether they are country names.</p>
<doc-anchor-target id="conditional-random-field-crf">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#conditional-random-field-crf">#</doc-anchor-trigger>
        <span>Conditional Random Field (CRF)</span>
    </h2>
</doc-anchor-target>
<p>To take advantage of the surrounding context when labelling tokens in a sequence, a commonly used method is <a href="https://en.wikipedia.org/wiki/Conditional_random_field">conditional random field</a> (CRF), first proposed by <a href="http://repository.upenn.edu/cgi/viewcontent.cgi?article=1162&amp;context=cis_papers">Lafferty et al.</a> in 2001. It is  a type of probabilistic graphical model that can be used to model sequential data, such as labels of words in a sentence.</p>
<p>This article is not intended to discuss the technical details of CRF. If you are interested, you are recommended to check out one of the following tutorials which provide very good explanation of how CRF works:</p>
<ul>
<li><a href="http://homepages.inf.ed.ac.uk/csutton/publications/crftut-fnt.pdf">An Introduction to Conditional
Random Fields</a> by Charles Sutton and Andrew McCallum</li>
<li><a href="http://blog.echen.me/2012/01/03/introduction-to-conditional-random-fields/">Introduction to Conditional Random Fields</a> by Edwin Chen</li>
</ul>
<p>In CRF, we will design a set of <strong>feature functions</strong> to extract features for each word in a sentence. During model training, CRF will try to determine the weights of different feature functions that will maximise the likelihood of the labels in the training data.</p>
<doc-anchor-target id="train-crf-model-in-python">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#train-crf-model-in-python">#</doc-anchor-trigger>
        <span>Train CRF Model in Python</span>
    </h2>
</doc-anchor-target>
<p>One of the commonly used CRF library is <a href="http://www.chokkan.org/software/crfsuite/">CRFSuite implemented by Naoaki Okazaki</a> in C/C++. The library is already easy to use given its command line interface. A Python binding to CRFSuite, <a href="https://github.com/scrapinghub/python-crfsuite">pycrfsuite</a> is available for using the API in Python. This Python module is exactly the module used in the POS tagger in the <a href="http://www.nltk.org/">nltk module</a>.</p>
<p>To demonstrate how pysrfsuite can be used to train a linear chained CRF sequence labelling model, we will go through an example using some data for <em>named entity recognition</em>.</p>
<doc-anchor-target id="named-entity-recogniton">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#named-entity-recogniton">#</doc-anchor-trigger>
        <span>Named Entity Recogniton</span>
    </h3>
</doc-anchor-target>
<p>To train a named entity recognition model, we need some labelled data. The dataset that will be used below is the <strong>Reuters-128 dataset</strong>, which is an English corpus in the NLP Interchange Format (NIF). It contains 128 economic news articles. The dataset contains information for <strong>880</strong> named entities with their position in the document and a URI of a <a href="http://wiki.dbpedia.org/">DBpedia</a> resource identifying the entity. It was created by the <a href="http://aksw.org/About.html">Agile Knowledge Engineering and Semantic Web research group at Leipzig University, Germany</a>. More details can be found in <a href="http://svn.aksw.org/papers/2014/LREC_N3NIFNERNED/public.pdf">their paper</a>.</p>
<p>In the following, we will use the XML verison of the dataset, which can be downloaded from <a href="https://github.com/AKSW/n3-collection">https://github.com/AKSW/n3-collection</a>. Below is some lines extracted from the XML data file:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">&lt;document id=&quot;8&quot;&gt;
  &lt;documenturi&gt;http://www.research.att.com/~lewis/Reuters-21578/15009&lt;/documenturi&gt;
  &lt;documentsource&gt;Reuters-21578&lt;/documentsource&gt;
  &lt;textwithnamedentities&gt;
    &lt;namedentityintext uri=&quot;http://aksw.org/notInWiki/Home_Intensive_Care_Inc&quot;&gt;Home Intensive Care Inc&lt;/namedentityintext&gt;
    &lt;simpletextpart&gt; said it has opened a Dialysis at Home office in &lt;/simpletextpart&gt;
    &lt;namedentityintext uri=&quot;http://dbpedia.org/resource/Philadelphia&quot;&gt;Philadelphia&lt;/namedentityintext&gt;
    &lt;simpletextpart&gt;, its 12th nationwide.&lt;/simpletextpart&gt;
  &lt;/textwithnamedentities&gt;
&lt;/document&gt;</code></pre>
</doc-codeblock></div>
<p>The XML block shown above refers to one of the documents in the dataset. The semantics is self-explanatory. The document has a sentence &#x27;Home Intensive Care Inc said it has opened a Dialysis at Home office in Philadelphia, its 12th nationwide&#x27;, in which <strong>Home Intensive Care Inc</strong> and <strong>Philadelphia</strong> are labelled as named entities.</p>
<doc-anchor-target id="prepare-the-dataset-for-training">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#prepare-the-dataset-for-training">#</doc-anchor-trigger>
        <span>Prepare the Dataset for Training</span>
    </h3>
</doc-anchor-target>
<p>In order to prepare the dataset for training, we need to label every word (or token) in the sentences to be either <em>irrelevant</em> or part of a <em>named entity</em>. Since the data is in XML format, we can make use of <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/">BeautifulSoup</a> to parse the file and extract the data as follows:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">from bs4 import BeautifulSoup as bs
from bs4.element import Tag
import codecs

# Read data file and parse the XML
with codecs.open(&quot;reuters.xml&quot;, &quot;r&quot;, &quot;utf-8&quot;) as infile:
    soup = bs(infile, &quot;html5lib&quot;)

docs = []
for elem in soup.find_all(&quot;document&quot;):
    texts = []

    # Loop through each child of the element under &quot;textwithnamedentities&quot;
    for c in elem.find(&quot;textwithnamedentities&quot;).children:
        if type(c) == Tag:
            if c.name == &quot;namedentityintext&quot;:
                label = &quot;N&quot;  # part of a named entity
            else:
                label = &quot;I&quot;  # irrelevant word
            for w in c.text.split(&quot; &quot;):
                if len(w) &gt; 0:
                    texts.append((w, label))
    docs.append(texts)</code></pre>
</doc-codeblock></div>
<p>The result will be a list of documents, each of which contains a list of (word, label) tuples. For example:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">&gt;&gt;&gt; doc[0][:10]
[('Paxar', 'N'),
 ('Corp', 'N'),
 ('said', 'I'),
 ('it', 'I'),
 ('has', 'I'),
 ('acquired', 'I'),
 ('Thermo-Print', 'N'),
 ...</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="generating-part-of-speech-tags">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#generating-part-of-speech-tags">#</doc-anchor-trigger>
        <span>Generating Part-of-Speech Tags</span>
    </h3>
</doc-anchor-target>
<p>To train a CRF model, we need to create features for each of the tokens in the sentences. One particularly useful feature in NLP is the <a href="https://en.wikipedia.org/wiki/Part-of-speech_tagging">part-of-speech (POS) tags</a> of the words. They indicates whether a word is a noun, a verb or an adjective. (In fact, a POS tagger is also usually a trained CRF model.)</p>
<p>We can use <a href="http://www.nltk.org/book/ch05.html">NLTK&#x27;s POS tagger</a> to generate the POS tags for the tokens in our documents as follows:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">import nltk
data = []
for i, doc in enumerate(docs):

    # Obtain the list of tokens in the document
    tokens = [t for t, label in doc]

    # Perform POS tagging
    tagged = nltk.pos_tag(tokens)

    # Take the word, POS tag, and its label
    data.append([(w, pos, label) for (w, label), (word, pos) in zip(doc, tagged)])</code></pre>
</doc-codeblock></div>
<p>The output of the above process will be a list of documents, each of which is a list of tuples with the word, its POS tag and its label:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">&gt;&gt;&gt; data[0]
[('Paxar', 'NNP', 'N'),
    ('Corp', 'NNP', 'N'),
    ('said', 'VBD', 'I'),
    ('it', 'PRP', 'I'),
    ('has', 'VBZ', 'I'),
    ('acquired', 'VBN', 'I'),
    ('Thermo-Print', 'NNP', 'N'),
    ...</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="generating-features">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#generating-features">#</doc-anchor-trigger>
        <span>Generating Features</span>
    </h3>
</doc-anchor-target>
<p>Given the POS tags, we can now continue to generate more features for each of the tokens in the dataset. The features that will be useful in the training process depends on the task at hand. Below are some of the commonly used features for a word <span class="math">w</span> in named entity recognition:</p>
<ul>
<li>The word <span class="math">w</span> itself (converted to lowercase for normalisation)</li>
<li>The prefix/suffix of <span class="math">w</span> (e.g. -ion)</li>
<li>The words surrounding <span class="math">w</span>, such as the previous and the next word</li>
<li>Whether <span class="math">w</span> is in uppercase or lowercase</li>
<li>Whether <span class="math">w</span> is a number, or contains digits</li>
<li>The POS tag of <span class="math">w</span>, and those of the surrounding words</li>
<li>Whether <span class="math">w</span> is or contains a special character (e.g. hypen, dollar sign)</li>
</ul>
<p>Below is a function for generating features for our documents. It takes a doc (in the form of a listof tuples as shown above), and an index (the $i$th document), and return the documents with features extracted. (A similar example can be found in <a href="https://github.com/scrapinghub/python-crfsuite/blob/master/examples/CoNLL%202002.ipynb">the repository of pyscrfsuite</a>.)</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">def word2features(doc, i):
    word = doc[i][0]
    postag = doc[i][1]

    # Common features for all words
    features = [
        'bias',
        'word.lower=' + word.lower(),
        'word[-3:]=' + word[-3:],
        'word[-2:]=' + word[-2:],
        'word.isupper=%s' % word.isupper(),
        'word.istitle=%s' % word.istitle(),
        'word.isdigit=%s' % word.isdigit(),
        'postag=' + postag
    ]

    # Features for words that are not
    # at the beginning of a document
    if i &gt; 0:
        word1 = doc[i-1][0]
        postag1 = doc[i-1][1]
        features.extend([
            '-1:word.lower=' + word1.lower(),
            '-1:word.istitle=%s' % word1.istitle(),
            '-1:word.isupper=%s' % word1.isupper(),
            '-1:word.isdigit=%s' % word1.isdigit(),
            '-1:postag=' + postag1
        ])
    else:
        # Indicate that it is the 'beginning of a document'
        features.append('BOS')

    # Features for words that are not
    # at the end of a document
    if i &lt; len(doc)-1:
        word1 = doc[i+1][0]
        postag1 = doc[i+1][1]
        features.extend([
            '+1:word.lower=' + word1.lower(),
            '+1:word.istitle=%s' % word1.istitle(),
            '+1:word.isupper=%s' % word1.isupper(),
            '+1:word.isdigit=%s' % word1.isdigit(),
            '+1:postag=' + postag1
        ])
    else:
        # Indicate that it is the 'end of a document'
        features.append('EOS')

    return features</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="training-the-model">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#training-the-model">#</doc-anchor-trigger>
        <span>Training the Model</span>
    </h3>
</doc-anchor-target>
<p>To train the model, we need to first prepare the training data and the corresponding labels. Also, to be able to investigate the accuracy of the model, we need to separate the data into training set and test set. Below are some codes for preparing the training data and test data, using the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html"><code v-pre>train_test_split</code> function in scikit-learn</a>.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">from sklearn.model_selection import train_test_split

# A function for extracting features in documents
def extract_features(doc):
    return [word2features(doc, i) for i in range(len(doc))]

# A function fo generating the list of labels for each document
def get_labels(doc):
    return [label for (token, postag, label) in doc]

X = [extract_features(doc) for doc in data]
y = [get_labels(doc) for doc in data]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)</code></pre>
</doc-codeblock></div>
<p>In <code v-pre>pycrfsuite</code>, A CRF model in can be trained by first creating a <strong>trainer</strong>, and then submit the training data and corresponding labels to the trainer. After that, set the parameters and call <code v-pre>train()</code> to start the training process. For the complete list of parameters, one can refer to the <a href="http://www.chokkan.org/software/crfsuite/manual.html#idp8849114176">documentation of CRFSuite</a>. With the very small dataset in this example, the training with <code v-pre>max_iterations=200</code> can be finished in a few seconds. Below is the code for creating the trainer and start training the model:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">import pycrfsuite
trainer = pycrfsuite.Trainer(verbose=True)

# Submit training data to the trainer
for xseq, yseq in zip(X_train, y_train):
    trainer.append(xseq, yseq)

# Set the parameters of the model
trainer.set_params({
    # coefficient for L1 penalty
    'c1': 0.1,

    # coefficient for L2 penalty
    'c2': 0.01,  

    # maximum number of iterations
    'max_iterations': 200,

    # whether to include transitions that
    # are possible, but not observed
    'feature.possible_transitions': True
})

# Provide a file name as a parameter to the train function, such that
# the model will be saved to the file when training is finished
trainer.train('crf.model')</code></pre>
</doc-codeblock></div>
<p>If you have set <code v-pre>verbose=True</code> when initialising the trainer, the trainer will print out the training progress as it is trained against the provided training data.</p>
<doc-anchor-target id="checking-the-results">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#checking-the-results">#</doc-anchor-trigger>
        <span>Checking the Results</span>
    </h3>
</doc-anchor-target>
<p>Once we have the model trained, we can apply it on our test data and see whether it gives reasonable results. Assuming that the model is saved to a file named <code v-pre>crf.model</code>. The following block of code shows how we can load the model into memory, and apply it on to our test data.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">tagger = pycrfsuite.Tagger()
tagger.open('crf.model')
y_pred = [tagger.tag(xseq) for xseq in X_test]

# Let's take a look at a random sample in the testing set
i = 12
for x, y in zip(y_pred[i], [x[1].split(&quot;=&quot;)[1] for x in X_test[i]]):
    print(&quot;%s (%s)&quot; % (y, x))

'''
The following will be printed:

sci-med (N)
life (N)
systems (N)
inc (N)
said (I)
its (I)
directors (I)
approved (I)
a (I)
previously (I)
...
'''</code></pre>
</doc-codeblock></div>
<p>The result looks reasonable as the first four words are correctly identified as part of a named entity.</p>
<p>To study the performance of the CRF tagger trained above in a more quantitative way, we can check the <strong>precision</strong> and <strong>recall</strong> on the test data. This can be done very easily using the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html"><code v-pre>classification_report</code> function in scikit-learn</a>. However, given that the predictions are sequences of tags, we need to transform the data into a list of labels before feeding them into the function.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">import numpy as np
from sklearn.metrics import classification_report

# Create a mapping of labels to indices
labels = {&quot;N&quot;: 1, &quot;I&quot;: 0}

# Convert the sequences of tags into a 1-dimensional array
predictions = np.array([labels[tag] for row in y_pred for tag in row])
truths = np.array([labels[tag] for row in y_test for tag in row])

# Print out the classification report
print(classification_report(
    truths, predictions,
    target_names=[&quot;I&quot;, &quot;N&quot;]))</code></pre>
</doc-codeblock></div>
<p>which will prints a report as follows:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-python"><code v-pre class="language-python">              precision   recall  f1-score   support
          I       0.98      0.98      0.98      3322
          N       0.85      0.85      0.85       405
avg / total       0.97      0.97      0.97      3727</code></pre>
</doc-codeblock></div>
<p>We can see that we have achieved 85% precision and 85% recall in predicting whether a word is part of a named entity. There are several things by which we can improve the performance, including creating better features or tuning the parameters of the CRF model.</p>
<doc-anchor-target id="source-codes">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#source-codes">#</doc-anchor-trigger>
        <span>Source Codes</span>
    </h3>
</doc-anchor-target>
<p>The source code for reproducing the above results can be found in the following github repository: <a href="https://github.com/albertauyeung/python-crf-named-entity-recognition">https://github.com/albertauyeung/python-crf-named-entity-recognition</a>.</p>
<doc-anchor-target id="references">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#references">#</doc-anchor-trigger>
        <span>References</span>
    </h2>
</doc-anchor-target>
<ul>
<li>Lafferty, J., McCallum, A., Pereira, F. (2001). <a href="http://repository.upenn.edu/cgi/viewcontent.cgi?article=1162&amp;context=cis_papers">&quot;Conditional random fields: Probabilistic models for segmenting and labeling sequence data&quot;</a>. Proc. 18th International Conf. on Machine Learning. Morgan Kaufmann. pp. 282–289.</li>
<li>Erdogan, H. (2010). <a href="http://www.icmla-conference.org/icmla10/CFP_Tutorial_files/hakan.pdf">Sequence Labeling: Generative and Discriminative Approaches - Hidden Markov Models, Conditional Random Fields and Structured SVMs</a>. ICMLA 2010 Tutorial.</li>
</ul>


<div class="flex items-center mt-6 mb-6">
    <span>
        <a href="/tags/">
            <svg class="inline-block -mb-px mr-1.5 text-blue-500 dark:text-blue-400" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" overflow="visible" fill="currentColor"><g><path d="M21.3 9.88l-8.59-8.59C12.52 1.11 12.27 1 12 1H2c-.55 0-1 .45-1 1v10c0 .27.11.52.29.71l8.59 8.58c.57.57 1.32.88 2.12.88s1.55-.31 2.12-.88l7.17-7.17a3.009 3.009 0 00.01-4.24zm-1.42 2.82l-7.17 7.17c-.39.39-1.02.39-1.42 0L3 11.59V3h8.59l8.29 8.29c.39.39.39 1.03 0 1.41z" /><path d="M7.01 6C6.45 6 6 6.45 6 7s.45 1 1 1 1-.45 1-1-.44-1-.99-1z" /></g></svg>
        </a>
        <span class="mr-2"><a href="/tags/python/" class="no-link inline-flex items-center justify-center font-medium leading-none whitespace-nowrap text-blue-500 dark:text-blue-400 border border-blue-500 dark:border-blue-400 hover:bg-blue-100 dark:hover:bg-transparent dark:hover:border-blue-200 dark:hover:text-blue-200 transition-colors duration-200 ease-out h-6 px-2 text-xs rounded-md">
    <span>python</span>
</a></span>
        <span class="mr-2"><a href="/tags/machine-learning/" class="no-link inline-flex items-center justify-center font-medium leading-none whitespace-nowrap text-blue-500 dark:text-blue-400 border border-blue-500 dark:border-blue-400 hover:bg-blue-100 dark:hover:bg-transparent dark:hover:border-blue-200 dark:hover:text-blue-200 transition-colors duration-200 ease-out h-6 px-2 text-xs rounded-md">
    <span>machine learning</span>
</a></span>
        <span class="mr-2"><a href="/tags/sequence-labelling/" class="no-link inline-flex items-center justify-center font-medium leading-none whitespace-nowrap text-blue-500 dark:text-blue-400 border border-blue-500 dark:border-blue-400 hover:bg-blue-100 dark:hover:bg-transparent dark:hover:border-blue-200 dark:hover:text-blue-200 transition-colors duration-200 ease-out h-6 px-2 text-xs rounded-md">
    <span>sequence labelling</span>
</a></span>
        <span class="mr-2"><a href="/tags/crf/" class="no-link inline-flex items-center justify-center font-medium leading-none whitespace-nowrap text-blue-500 dark:text-blue-400 border border-blue-500 dark:border-blue-400 hover:bg-blue-100 dark:hover:bg-transparent dark:hover:border-blue-200 dark:hover:text-blue-200 transition-colors duration-200 ease-out h-6 px-2 text-xs rounded-md">
    <span>crf</span>
</a></span>
    </span>
</div>


                <!-- Required only on API pages -->
                <doc-toolbar-member-filter-no-results />
            </div>

            
<nav class="flex mt-14">
    <div class="w-1/2">
        <a class="px-5 py-4 h-full flex items-center break-all md:break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="/2017/07/08/fast-pandas-operation.html/">
            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
            <span>
                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                <span class="block mt-1">Making pandas Operations Faster</span>
            </span>
        </a>
    </div>

    <div class="w-1/2">
        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-all md:break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="/2017/04/23/python-matrix-factorization.html/">
            <span>
                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                <span class="block mt-1">Matrix Factorization: A Simple Tutorial and Implementation in Python</span>
            </span>
            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
        </a>
    </div>
</nav>


        </main>

        <div class="border-t dark:border-dark-650 pt-6 mb-8">
            <footer class="flex flex-wrap items-center justify-between">
    <div>
        <ul class="flex flex-wrap items-center text-sm">
</ul>

    </div>
    <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"><p>© Copyright 2021. All rights reserved.</p>
</div>
</footer>

        </div>
    </div>
    
    <!-- Rendered if sidebar right is enabled -->
    <!-- Sidebar right skeleton-->
    <div v-cloak class="fixed top-0 bottom-0 right-0 transform translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:flex-shrink-0 lg:pt-6 lg:transform-none lg:w-56 lg:z-0 md:w-72 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
        <div class="pl-5">
            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
        </div>
    </div>
    
    <!-- User should be able to hide sidebar right -->
    <doc-sidebar-right v-cloak></doc-sidebar-right>
</div>

        </div>
    </div>

    <doc-search-mobile></doc-search-mobile>
    <doc-back-to-top></doc-back-to-top>
</div>


        <div id="docs-overlay-target"></div>

        <script>window.__DOCS__ = { "title": "Performing Sequence Labelling using CRF in Python", icon: "file", hasPrism: true, hasMermaid: false, hasMath: true }</script>
    </body>
</html>
